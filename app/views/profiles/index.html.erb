<%# Main Profile Page, e.g Character List, Groups user is a part of, Events User is participating in %>
<h1>Profile</h1> 
<style> 
  article{
    display: flex;
  }
  div{
    padding: 10px;
    border: 2px solid black;
    padding: 10px;
  }
</style>
<%= @user.email %>
<article>
<%# Character List Card %>
<div> 
  <h1>My Characters </h1>
  <%= link_to 'New Character' , new_character_path %>
  <% @user.characters.each do |character| %>
    <h2><%= link_to character.name, character %></h2>
    <p><%= character.race %></p> 
    <p><%= character.alignment %></p>
    <p><%= character.class %></p>
    <p> Level: <%= character.level%></p>
    <%= link_to 'Edit', user_edit_character_path(character) %>
    <%= link_to 'Delete', user_delete_character_path(character), method: :delete %>
  <% end %>
</div>

<%# <% @user.approved_groups.each do |group| %>
<%# <p><%= group.name %></p>
<%# <% end %>
<% if @user.has_role? :admin %>
<div>
  <h1>Group Join Requests</h1>
  <p> You are an admin </p>
  <% @user.groups.each do |group| %>
    <% group.un_approved_users.each do |member| %>
      <%= member.email %>
      <%= member.id%>
      <%= form_with model: @groups , url: accept_request_path, method: :post do |f| %>
        <%= f.hidden_field :user_id, value: member.id %>
        <%= f.hidden_field :group_id, value: group.id%> 
        <%= f.submit 'Accept'%>
      <% end %>
    <% end %>
  <% end %>
</div>
<% end %>


<%# Group List Card %>
<div>
  <h1> My Groups</h1>
  <% current_user.approved_groups.each do |group| %>
    <h3><%= group.name %></h3><%= link_to 'Delete', delete_group_path(group), method: :delete if current_user.has_role? :admin%>
  <% end %>
  <%# Authorizing Function, if User is an admin they will be able to create new groups %>
  <% if current_user.has_role? :admin %>
    <%= link_to 'New Group', new_group_path %>
  <% end %>
<%# If the user wants to find another group, this will link to the find.html.erb %>
  <%= form_with url: find_path, method: :post do |f| %>
    <%= f.text_field :name %>
    <%= f.submit 'Find a Group' %>
  <% end %>
  
</div>

<%# Event List Card %>

<div>
  <h1> Games</h1>
    <%= link_to 'New Game', new_game_path if current_user.has_role? :admin %>
  <% current_user.approved_groups.each do |group| %>
    <h2><%= group.name %></h2>
    <% group.games.each do |game| %>  
      <h3><%= game.name %></h3>
      <p>Time of Game:<%= game.time %></p>
      <p>Date of Event: <%= game.date %></p>
      <% if current_user.has_role? :admin %>
      <%= link_to 'Delete' , games_path(game), method: :delete %>
      <%= link_to 'Edit' , edit_game_path(game) %>
      <% end %>
    <% end %>
  <% end %>
</div>

</article>